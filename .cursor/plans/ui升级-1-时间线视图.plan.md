---
name: UIå‡çº§å­Plan 1 - æ—¶é—´çº¿è§†å›¾
overview: å°†æ¶ˆæ¯åˆ—è¡¨å‡çº§ä¸ºæ—¶é—´çº¿æ­¥éª¤è§†å›¾ï¼ŒåŒ…å«å®Œæ•´çš„CSSæ ·å¼ã€HTMLç»“æ„å’ŒJavaScripté€»è¾‘ã€‚è¿™æ˜¯UIå‡çº§çš„åŸºç¡€æ¨¡å—ï¼ŒåŒ…å«CSSå˜é‡ç³»ç»Ÿä¾›åç»­å­Planä¾èµ–ã€‚
todos:
  - id: p0-backup
    content: 'P0.1: åˆ›å»º UI å‡çº§åˆ†æ”¯å¹¶å¤‡ä»½å½“å‰ style.css'
    status: pending
  - id: p1-css-status-colors
    content: 'P1.1: æ·»åŠ çŠ¶æ€è‰²å˜é‡ (success/error/info/running) [éªŒæ”¶: DevTools æ£€æŸ¥ 8 ä¸ªå˜é‡]'
    status: pending
  - id: p1-css-radius
    content: 'P1.2: æ·»åŠ åœ†è§’å˜é‡ (sm/md/lg/xl) [éªŒæ”¶: 4 ä¸ªå˜é‡å­˜åœ¨]'
    status: pending
  - id: p1-css-shadows
    content: 'P1.3: æ·»åŠ é˜´å½±å˜é‡ (soft/input/card) [éªŒæ”¶: 3 ä¸ªå˜é‡å­˜åœ¨]'
    status: pending
  - id: p1-css-transitions
    content: 'P1.4: æ·»åŠ è¿‡æ¸¡åŠ¨ç”»å˜é‡ (fast/normal/slow) [éªŒæ”¶: 3 ä¸ªå˜é‡å­˜åœ¨]'
    status: pending
  - id: p1-css-breakpoints
    content: 'P1.5: æ·»åŠ å“åº”å¼æ–­ç‚¹å˜é‡ (768px/1024px/1280px) [éªŒæ”¶: åª’ä½“æŸ¥è¯¢å¯ç”¨]'
    status: pending
  - id: p2-timeline-container
    content: 'P2.1: æ·»åŠ  .timeline-container åŸºç¡€å¸ƒå±€ [éªŒæ”¶: ç©ºå®¹å™¨æ­£ç¡®æ˜¾ç¤º]'
    status: pending
  - id: p2-step-marker
    content: 'P2.2: æ·»åŠ  .step-marker åŠ 4 ç§çŠ¶æ€æ ·å¼ [éªŒæ”¶: 4 ç§é¢œè‰²åœ†ç‚¹]'
    status: pending
  - id: p2-step-line
    content: 'P2.3: æ·»åŠ æ­¥éª¤ä¹‹é—´çš„è¿æ¥çº¿æ ·å¼ [éªŒæ”¶: è¿æ¥çº¿æ˜¾ç¤º]'
    status: pending
  - id: p2-step-content
    content: 'P2.4: æ·»åŠ  .step-content å¡ç‰‡æ ·å¼ [éªŒæ”¶: å¡ç‰‡æœ‰åœ†è§’å’Œé˜´å½±]'
    status: pending
  - id: p2-step-collapse
    content: 'P2.5: æ·»åŠ å¡ç‰‡æŠ˜å /å±•å¼€åŠ¨ç”» [éªŒæ”¶: ç‚¹å‡»å¤´éƒ¨å¯æŠ˜å ]'
    status: pending
  - id: p2-step-states
    content: 'P2.6: æ·»åŠ å½“å‰/å†å²æ­¥éª¤è§†è§‰å±‚æ¬¡ [éªŒæ”¶: å½“å‰æ­¥éª¤é«˜äº®]'
    status: pending
  - id: p7-timeline-wrapper
    content: 'P7.2: æ·»åŠ  timeline-container åŒ…è£…å™¨ [éªŒæ”¶: å®¹å™¨å­˜åœ¨]'
    status: pending
  - id: p7-timeline-step-tpl
    content: 'P7.3: æ·»åŠ æ—¶é—´çº¿æ­¥éª¤æ¨¡æ¿ç»“æ„ [éªŒæ”¶: åŒ…å« marker + content]'
    status: pending
  - id: p9-empty-timeline
    content: 'P9.1: æ·»åŠ æ—¶é—´çº¿ç©ºçŠ¶æ€ UI [éªŒæ”¶: æ— æ­¥éª¤æ—¶æ˜¾ç¤ºå¼•å¯¼]'
    status: pending
  - id: p9-error-state
    content: 'P9.3: æ·»åŠ æ­¥éª¤å¤±è´¥çŠ¶æ€ UI [éªŒæ”¶: é”™è¯¯æ—¶æ˜¾ç¤ºé‡è¯•æŒ‰é’®]'
    status: pending
  - id: p10-build-step-html
    content: 'P10.1: å®ç° buildTimelineStepHTML() [éªŒæ”¶: å•å…ƒæµ‹è¯•é€šè¿‡]'
    status: pending
  - id: p10-render-timeline
    content: 'P10.2: å®ç° renderTimelineStep() æ›¿æ¢ renderMessage [éªŒæ”¶: æ¶ˆæ¯æ˜¾ç¤ºä¸ºæ­¥éª¤]'
    status: pending
  - id: p10-step-collapse-js
    content: 'P10.3: å®ç°æ­¥éª¤æŠ˜å /å±•å¼€äº¤äº’ [éªŒæ”¶: ç‚¹å‡»å¯æŠ˜å ]'
    status: pending
  - id: p10-auto-scroll
    content: 'P10.4: å®ç°æ–°æ­¥éª¤è‡ªåŠ¨æ»šåŠ¨ [éªŒæ”¶: æ–°æ­¥éª¤è‡ªåŠ¨è¿›å…¥è§†å£]'
    status: pending
  - id: p13-state-vars-timeline
    content: 'P13.1a: æ·»åŠ  timelineSteps çŠ¶æ€å˜é‡'
    status: pending
---

# UIå‡çº§å­Plan 1: æ—¶é—´çº¿è§†å›¾å®Œæ•´åŠŸèƒ½

## æ¦‚è¿°

æœ¬å­Planå®ç°æ—¶é—´çº¿è§†å›¾çš„å®Œæ•´åŠŸèƒ½ï¼Œå°†åŸæœ‰çš„æ¶ˆæ¯åˆ—è¡¨å‡çº§ä¸ºå¯è§†åŒ–çš„æ­¥éª¤æ—¶é—´çº¿ã€‚ä½œä¸ºUIå‡çº§çš„ç¬¬ä¸€ä¸ªå­Planï¼Œè¿˜åŒ…å«CSSå˜é‡ç³»ç»Ÿï¼ˆä¾›åç»­å­Planå¤ç”¨ï¼‰ã€‚

**ä»»åŠ¡æ•°é‡**: 21 ä¸ª
**é¢„ä¼°æ—¶é—´**: ~3 å°æ—¶

## ä¾èµ–å…³ç³»

```
P0.1 å‡†å¤‡å·¥ä½œ
  â†“
P1.1-P1.5 CSSå˜é‡ç³»ç»Ÿ (å¹¶è¡Œ)
  â†“
P2.1-P2.6 æ—¶é—´çº¿CSSæ ·å¼
  â†“
P7.2-P7.3 æ—¶é—´çº¿HTMLç»“æ„
  â†“
P9.1, P9.3 ç©ºçŠ¶æ€/é”™è¯¯çŠ¶æ€
  â†“
P10.1-P10.4 æ—¶é—´çº¿JSé€»è¾‘
  â†“
P13.1a çŠ¶æ€å˜é‡
```

---

## Phase 0: å‡†å¤‡å·¥ä½œ

| ID   | ä»»åŠ¡                                                | éªŒæ”¶æ ‡å‡†               |
| ---- | --------------------------------------------------- | ---------------------- |
| P0.1 | åˆ›å»ºåˆ†æ”¯ `feature/ui-upgrade-v2` å¹¶å¤‡ä»½ `style.css` | åˆ†æ”¯å­˜åœ¨ï¼Œå¤‡ä»½æ–‡ä»¶å­˜åœ¨ |

---

## Phase 1: CSS å˜é‡ç³»ç»Ÿ

**æ–‡ä»¶**: `renderer/style.css`

æ­¤é˜¶æ®µæ·»åŠ çš„å˜é‡å°†è¢«åç»­å­Plan (Tabé¢æ¿ã€å“åº”å¼) å¤ç”¨ã€‚

| ID   | ä»»åŠ¡         | éªŒæ”¶æ ‡å‡†     |
| ---- | ------------ | ------------ |
| P1.1 | çŠ¶æ€è‰²å˜é‡   | 8 ä¸ªå˜é‡å­˜åœ¨ |
| P1.2 | åœ†è§’å˜é‡     | 4 ä¸ªå˜é‡å­˜åœ¨ |
| P1.3 | é˜´å½±å˜é‡     | 3 ä¸ªå˜é‡å­˜åœ¨ |
| P1.4 | è¿‡æ¸¡åŠ¨ç”»å˜é‡ | 3 ä¸ªå˜é‡å­˜åœ¨ |
| P1.5 | å“åº”å¼æ–­ç‚¹   | åª’ä½“æŸ¥è¯¢å¯ç”¨ |

### CSSå˜é‡ä»£ç 

```css
/* P1.1 çŠ¶æ€è‰² */
--status-success: #4ade80;
--status-success-bg: rgba(74, 222, 128, 0.12);
--status-error: #ef4444;
--status-error-bg: rgba(239, 68, 68, 0.12);
--status-info: #5b8def;
--status-info-bg: rgba(91, 141, 239, 0.12);
--status-running: #c4917b;
--status-running-bg: rgba(196, 145, 123, 0.15);

/* P1.2 åœ†è§’ */
--radius-sm: 6px;
--radius-md: 10px;
--radius-lg: 14px;
--radius-xl: 20px;

/* P1.3 é˜´å½± */
--shadow-soft: 0 2px 8px rgba(0, 0, 0, 0.04);
--shadow-input: 0 4px 16px rgba(0, 0, 0, 0.06);
--shadow-card: 0 2px 12px rgba(0, 0, 0, 0.06);

/* P1.4 è¿‡æ¸¡ */
--transition-fast: 150ms ease-out;
--transition-normal: 250ms ease-out;
--transition-slow: 350ms ease-out;
```

---

## Phase 2: æ—¶é—´çº¿æ ·å¼

**æ–‡ä»¶**: `renderer/style.css`

| ID   | ä»»åŠ¡                    | éªŒæ”¶æ ‡å‡†       | ä¾èµ–       |
| ---- | ----------------------- | -------------- | ---------- |
| P2.1 | timeline-container å¸ƒå±€ | ç©ºå®¹å™¨æ­£ç¡®æ˜¾ç¤º | P1.1       |
| P2.2 | step-marker 4 ç§çŠ¶æ€    | 4 ç§é¢œè‰²åœ†ç‚¹   | P2.1       |
| P2.3 | æ­¥éª¤è¿æ¥çº¿              | è¿æ¥çº¿æ˜¾ç¤º     | P2.2       |
| P2.4 | step-content å¡ç‰‡       | æœ‰åœ†è§’å’Œé˜´å½±   | P2.1       |
| P2.5 | æŠ˜å /å±•å¼€åŠ¨ç”»           | ç‚¹å‡»å¯æŠ˜å      | P2.4, P1.4 |
| P2.6 | å½“å‰/å†å²è§†è§‰å±‚æ¬¡       | å½“å‰æ­¥éª¤é«˜äº®   | P2.4       |

### æ—¶é—´çº¿CSSç»“æ„

```css
/* P2.1 å®¹å™¨ */
.timeline-container {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
}

.timeline {
  display: flex;
  flex-direction: column;
  gap: 0;
}

/* P2.2 æ­¥éª¤æ ‡è®° */
.timeline-step {
  display: flex;
  gap: 16px;
  position: relative;
}

.step-marker {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  flex-shrink: 0;
  margin-top: 6px;
}

.step-marker.success {
  background: var(--status-success);
}
.step-marker.error {
  background: var(--status-error);
}
.step-marker.info {
  background: var(--status-info);
}
.step-marker.running {
  background: var(--status-running);
  animation: pulse 1.5s infinite;
}

/* P2.3 è¿æ¥çº¿ */
.timeline-step:not(:last-child)::before {
  content: '';
  position: absolute;
  left: 5px;
  top: 24px;
  bottom: -8px;
  width: 2px;
  background: var(--border-color);
}

/* P2.4 å†…å®¹å¡ç‰‡ */
.step-content {
  flex: 1;
  background: var(--bg-secondary);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-card);
  overflow: hidden;
}

/* P2.5 æŠ˜å åŠ¨ç”» */
.step-body {
  max-height: 1000px;
  overflow: hidden;
  transition: max-height var(--transition-normal);
}

.step-content.collapsed .step-body {
  max-height: 0;
}

/* P2.6 è§†è§‰å±‚æ¬¡ */
.timeline-step.current .step-content {
  border-left: 3px solid var(--accent-color);
}

.timeline-step.history .step-content {
  opacity: 0.85;
}
```

---

## Phase 7: HTML ç»“æ„ (æ—¶é—´çº¿éƒ¨åˆ†)

**æ–‡ä»¶**: `renderer/index.html`

| ID   | ä»»åŠ¡                           | éªŒæ”¶æ ‡å‡†              |
| ---- | ------------------------------ | --------------------- |
| P7.2 | æ·»åŠ  timeline-container åŒ…è£…å™¨ | å®¹å™¨å­˜åœ¨              |
| P7.3 | æ·»åŠ æ—¶é—´çº¿æ­¥éª¤æ¨¡æ¿ç»“æ„         | åŒ…å« marker + content |

### HTMLæ¨¡æ¿

```html
<!-- P7.2 + P7.3 æ—¶é—´çº¿å®¹å™¨ -->
<div class="timeline-container" id="timelineContainer">
  <div class="timeline" id="timeline">
    <!-- æ—¶é—´çº¿æ­¥éª¤ç”± JS åŠ¨æ€æ¸²æŸ“ -->
  </div>

  <!-- P9.1 ç©ºçŠ¶æ€ -->
  <div class="empty-state" id="timelineEmpty">
    <div class="empty-icon">ğŸ“‹</div>
    <p>å¼€å§‹å¯¹è¯ï¼Œè¿™é‡Œå°†æ˜¾ç¤ºæ‰§è¡Œæ­¥éª¤...</p>
  </div>
</div>
```

---

## Phase 9: ç©ºçŠ¶æ€ä¸é”™è¯¯çŠ¶æ€

| ID   | ä»»åŠ¡            | éªŒæ”¶æ ‡å‡†           |
| ---- | --------------- | ------------------ |
| P9.1 | æ—¶é—´çº¿ç©ºçŠ¶æ€ UI | æ— æ­¥éª¤æ—¶æ˜¾ç¤ºå¼•å¯¼   |
| P9.3 | æ­¥éª¤å¤±è´¥çŠ¶æ€ UI | é”™è¯¯æ—¶æ˜¾ç¤ºé‡è¯•æŒ‰é’® |

---

## Phase 10: JavaScript é€»è¾‘

**æ–‡ä»¶**: `renderer/uiHelpers.js`, `renderer/renderer.js`

| ID    | ä»»åŠ¡                         | éªŒæ”¶æ ‡å‡†           |
| ----- | ---------------------------- | ------------------ |
| P10.1 | å®ç° buildTimelineStepHTML() | å•å…ƒæµ‹è¯•é€šè¿‡       |
| P10.2 | å®ç° renderTimelineStep()    | æ¶ˆæ¯æ˜¾ç¤ºä¸ºæ­¥éª¤     |
| P10.3 | å®ç°æ­¥éª¤æŠ˜å /å±•å¼€äº¤äº’        | ç‚¹å‡»å¯æŠ˜å          |
| P10.4 | å®ç°æ–°æ­¥éª¤è‡ªåŠ¨æ»šåŠ¨           | æ–°æ­¥éª¤è‡ªåŠ¨è¿›å…¥è§†å£ |

### æ ¸å¿ƒå‡½æ•°ç­¾å

```javascript
// P10.1 æ„å»ºæ—¶é—´çº¿æ­¥éª¤ HTML
export function buildTimelineStepHTML(step) {
  // step: { id, type, status, content, timestamp, collapsed }
  // returns: HTML string
}

// P10.2 æ¸²æŸ“æ—¶é—´çº¿æ­¥éª¤
export function renderTimelineStep(step) {
  // åœ¨ timeline å®¹å™¨ä¸­æ·»åŠ /æ›´æ–°æ­¥éª¤
}

// P10.3 æŠ˜å /å±•å¼€
export function toggleStepCollapse(stepId) {
  // åˆ‡æ¢æ­¥éª¤çš„æŠ˜å çŠ¶æ€
}

// P10.4 è‡ªåŠ¨æ»šåŠ¨
export function scrollToLatestStep() {
  // æ»šåŠ¨åˆ°æœ€æ–°æ­¥éª¤
}
```

---

## Phase 13: çŠ¶æ€å˜é‡

| ID     | ä»»åŠ¡                        | éªŒæ”¶æ ‡å‡†         |
| ------ | --------------------------- | ---------------- |
| P13.1a | æ·»åŠ  timelineSteps çŠ¶æ€å˜é‡ | å˜é‡å­˜åœ¨å¹¶å¯è¯»å†™ |

```javascript
// renderer.js æˆ– chatStore.js
let timelineSteps = []; // å½“å‰èŠå¤©çš„æ—¶é—´çº¿æ­¥éª¤
```

---

## éªŒæ”¶æ£€æŸ¥æ¸…å•

å®Œæˆæœ¬å­Planåï¼Œé€é¡¹éªŒè¯ï¼š

- [ ] CSSå˜é‡ç³»ç»Ÿå®Œæ•´ (18ä¸ªå˜é‡)
- [ ] æ—¶é—´çº¿å®¹å™¨æ­£ç¡®æ¸²æŸ“
- [ ] ç”¨æˆ·/åŠ©æ‰‹/å·¥å…· 3 ç§æ­¥éª¤ç±»å‹æ˜¾ç¤º
- [ ] 4 ç§çŠ¶æ€é¢œè‰²æ­£ç¡® (success/error/info/running)
- [ ] æ­¥éª¤å¯æŠ˜å /å±•å¼€ï¼ŒåŠ¨ç”»æµç•…
- [ ] ç©ºçŠ¶æ€æ­£ç¡®æ˜¾ç¤ºï¼ˆæ— æ­¥éª¤æ—¶ï¼‰
- [ ] é”™è¯¯çŠ¶æ€æ­£ç¡®æ˜¾ç¤ºï¼ˆæ­¥éª¤å¤±è´¥æ—¶ï¼‰
- [ ] æ–°æ­¥éª¤è‡ªåŠ¨æ»šåŠ¨è¿›å…¥è§†å£

## éªŒè¯å‘½ä»¤

```bash
# è¿è¡Œç›¸å…³E2Eæµ‹è¯•
npm run test:e2e -- --grep "æ—¶é—´çº¿"

# æ‰‹åŠ¨éªŒè¯
# 1. å¯åŠ¨åº”ç”¨ï¼šnpm start
# 2. å‘é€ä¸€æ¡æ¶ˆæ¯
# 3. è§‚å¯Ÿæ—¶é—´çº¿æ­¥éª¤æ¸²æŸ“
# 4. ç‚¹å‡»æ­¥éª¤å¤´éƒ¨éªŒè¯æŠ˜å åŠŸèƒ½
```

---

## ä¸å…¶ä»–å­Plançš„æ¥å£

æœ¬å­Planä¸ºåç»­å­Planæä¾›ï¼š

1. **CSSå˜é‡ç³»ç»Ÿ** - æ‰€æœ‰çŠ¶æ€è‰²ã€åœ†è§’ã€é˜´å½±ã€è¿‡æ¸¡å˜é‡
2. **æ—¶é—´çº¿å®¹å™¨** - `#timelineContainer` å…ƒç´ 
3. **æ­¥éª¤æ¸²æŸ“å‡½æ•°** - `buildTimelineStepHTML()`, `renderTimelineStep()`

åç»­å­Planä¸éœ€è¦ä¿®æ”¹æœ¬å­Plançš„ä»£ç ï¼Œåªéœ€ä½¿ç”¨å·²å®šä¹‰çš„æ¥å£ã€‚
