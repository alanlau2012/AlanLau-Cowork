---
name: UXå‡çº§è®¡åˆ’
overview: å¯¹ Open Claude Cowork é¡¹ç›®è¿›è¡Œå…¨é¢çš„ç”¨æˆ·ä½“éªŒå‡çº§ï¼Œèšç„¦æ ¸å¿ƒç—›ç‚¹è§£å†³ã€åŠŸèƒ½å¢å¼ºä¸ä½“éªŒæ‰“ç£¨ï¼Œåˆ†ä¸‰ä¸ªé˜¶æ®µè¿­ä»£å®æ–½ã€‚
todos:
  - id: phase1-textarea
    content: å°†è¾“å…¥æ¡†æ”¹ä¸ºå¤šè¡Œ textarea å¹¶å®ç°è‡ªåŠ¨é«˜åº¦æ‰©å±•ä¸é˜²è¯¯è§¦
    status: pending
  - id: phase1-stop-btn
    content: æ·»åŠ åœæ­¢ç”ŸæˆæŒ‰é’®ï¼Œæ”¯æŒä¸­æ–­é•¿å“åº” (IPC Mapå®ç°)
    status: pending
  - id: phase1-retry
    content: å®ç°ç½‘ç»œé”™è¯¯é‡è¯•æœºåˆ¶
    status: pending
  - id: phase1-templates
    content: æ·»åŠ é¦–é¡µå¿«é€Ÿå¼€å§‹æ¨¡æ¿å¡ç‰‡ï¼ˆç®€åŒ–ç‰ˆ3ä¸ªï¼‰
    status: pending
  - id: phase1-toast
    content: å®ç° Toast é€šçŸ¥ç»„ä»¶æ›¿ä»£ alert
    status: pending
  - id: phase2-codeblock
    content: ä¼˜åŒ–ä»£ç å—ä½“éªŒï¼ˆå¤åˆ¶æŒ‰é’®/è¯­è¨€æ ‡è¯†/é«˜äº®ï¼‰
    status: pending
  - id: phase2-search
    content: å®ç°èŠå¤©å†å²æœç´¢åŠŸèƒ½
    status: pending
  - id: phase2-timegroup
    content: æ·»åŠ èŠå¤©å†å²æ—¶é—´åˆ†ç»„æ ‡ç­¾
    status: pending
  - id: phase2-regenerate
    content: æ·»åŠ é‡æ–°ç”ŸæˆæŒ‰é’®
    status: pending
  - id: phase2-loading
    content: ä¸°å¯ŒåŠ è½½çŠ¶æ€æ˜¾ç¤ºï¼ˆåŒºåˆ†æ€è€ƒ/å·¥å…·/ç”Ÿæˆï¼‰
    status: pending
  - id: phase3-theme
    content: å®ç°æ·±è‰²/æµ…è‰²ä¸»é¢˜åˆ‡æ¢
    status: pending
  - id: phase3-keyboard
    content: æ·»åŠ é”®ç›˜å¿«æ·é”®æ”¯æŒ
    status: pending
  - id: phase3-a11y
    content: å¯è®¿é—®æ€§æ”¹è¿›ï¼ˆARIA/é”®ç›˜å¯¼èˆªï¼‰
    status: pending
  - id: phase3-settings
    content: æ·»åŠ è®¾ç½®é¡µé¢/æ¨¡æ€æ¡†
    status: pending
---

# Open Claude Cowork UX å‡çº§è®¡åˆ’ v2.1

## é¡¹ç›®èƒŒæ™¯

å½“å‰é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº Claude Agent SDK çš„æ¡Œé¢èŠå¤©åŠ©æ‰‹ï¼Œå…·å¤‡å¤šä¼šè¯ç®¡ç†ã€500+ å·¥å…·è°ƒç”¨ã€å®æ—¶æµå¼å“åº”ç­‰æ ¸å¿ƒèƒ½åŠ›ã€‚æœ¬æ¬¡å‡çº§èšç„¦äº**ç”¨æˆ·äº¤äº’ä½“éªŒ**çš„å…¨é¢ä¼˜åŒ–ã€‚

## å‡çº§åŸåˆ™

> **ä¼˜å…ˆçº§æ’åºåŸåˆ™ï¼šç”¨æˆ·ç—›ç‚¹ > åŠŸèƒ½å®Œå–„ > ç¾è§‚ä¼˜åŒ–**
> **æ ¸å¿ƒç†å¿µï¼šHelpful (å®ç”¨), Honest (è¯šå®åé¦ˆ), Harmless (æ— æŒ«è´¥æ„Ÿ)**

## å‡çº§æ¶æ„æ¦‚è§ˆ

```mermaid
flowchart TB
    subgraph Phase1 [Phase 1: åŸºç¡€æ¶æ„ä¸æ ¸å¿ƒä½“éªŒ ğŸ”´ P0]
        direction TB
        A1[å¤šè¡Œè¾“å…¥ + æ™ºèƒ½é˜²è¯¯è§¦]
        A2[åœæ­¢ç”Ÿæˆ (IPC Mapå®ç°)]
        A3[åŸºç¡€ Toast é€šçŸ¥ç³»ç»Ÿ]
        A4[ç½‘ç»œé”™è¯¯é‡è¯•]
        A5[é¦–é¡µå¿«é€Ÿæ¨¡æ¿]
    end

    subgraph Phase2 [Phase 2: å¼€å‘è€…ä½“éªŒä¸å¢å¼º ğŸŸ¡ P1]
        direction TB
        B1[ä»£ç å—ä½“éªŒä¼˜åŒ–]
        B2[èŠå¤©å†å²æœç´¢]
        B3[æ—¶é—´åˆ†ç»„æ ‡ç­¾]
        B4[é‡æ–°ç”ŸæˆæŒ‰é’®]
        B5[ä¸°å¯ŒåŠ è½½çŠ¶æ€ (æ€è€ƒ/å·¥å…·)]
    end

    subgraph Phase3 [Phase 3: æƒ…æ„ŸåŒ–ä¸ä¸ªæ€§åŒ– ğŸŸ¢ P2]
        direction TB
        C1[ä¸»é¢˜åˆ‡æ¢]
        C2[é”®ç›˜å¿«æ·é”®]
        C3[å¯è®¿é—®æ€§æ”¹è¿›]
        C4[è®¾ç½®é¡µé¢]
    end

    Phase1 --> Phase2 --> Phase3
```

---

## Phase 1: åŸºç¡€æ¶æ„ä¸æ ¸å¿ƒä½“éªŒ (P0)

**ç›®æ ‡ï¼šè§£å†³å½“å‰æœ€å½±å“ç”¨æˆ·ä½“éªŒçš„æ ¸å¿ƒç—›ç‚¹ï¼Œå»ºç«‹ç¨³å¥çš„äº¤äº’åŸºç¡€**

### 1.1 å¤šè¡Œè¾“å…¥æ”¯æŒ (Textarea++)

**ç›®æ ‡**: æ”¯æŒå¤æ‚ä»»åŠ¡çš„å¤šè¡Œè¾“å…¥ï¼Œæå‡è¾“å…¥ä½“éªŒï¼Œé˜²æ­¢ä»£ç è¾“å…¥æ—¶çš„è¯¯å‘é€ã€‚

**ç—›ç‚¹åˆ†æ**:

1. å½“å‰å•è¡Œ `<input>` æ— æ³•è¾“å…¥å¤šè¡Œä»£ç ã€‚
2. ç²˜è´´ä»£ç æ—¶å®¹æ˜“å› ä¹ æƒ¯æŒ‰ Enter è€Œæ„å¤–å‘é€ã€‚

**æ”¹åŠ¨æ–‡ä»¶**:

- [`renderer/index.html`](renderer/index.html): å°† `<input>` æ”¹ä¸º `<textarea>`
- [`renderer/style.css`](renderer/style.css): æ·»åŠ è‡ªåŠ¨é«˜åº¦æ‰©å±•æ ·å¼
- [`renderer/renderer.js`](renderer/renderer.js): å®ç°è‡ªåŠ¨é«˜åº¦è°ƒæ•´ä¸æ™ºèƒ½é˜²è¯¯è§¦

**å…³é”®å®ç°**:

````javascript
// æ™ºèƒ½é˜²è¯¯è§¦é€»è¾‘
function handleEnterKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    const value = e.target.value;
    // æ£€æµ‹æ˜¯å¦æœ‰æœªé—­åˆçš„ä»£ç å— (å¥‡æ•°ä¸ª ```)
    const backtickCount = (value.match(/```/g) || []).length;

    if (backtickCount % 2 !== 0) {
      // ä»£ç å—æœªé—­åˆï¼ŒEnter è¡Œä¸ºæ”¹ä¸ºæ¢è¡Œ
      e.preventDefault();
      insertNewlineAtCursor(e.target);
      return;
    }

    // æ­£å¸¸å‘é€
    e.preventDefault();
    sendMessage();
  }
}
````

**äº¤äº’è§„èŒƒ**:

- **Enter**: å‘é€æ¶ˆæ¯ï¼ˆé™¤éåœ¨æœªé—­åˆçš„ä»£ç å—ä¸­ï¼‰
- **Shift+Enter**: å¼ºåˆ¶æ¢è¡Œ
- **é«˜åº¦åŠ¨ç”»**: ä½¿ç”¨ `requestAnimationFrame` ç¡®ä¿é«˜åº¦å˜åŒ–å¹³æ»‘æ— æŠ–åŠ¨

**é¢„ä¼°å·¥æ—¶**: 2.5h

---

### 1.2 åœæ­¢ç”ŸæˆæŒ‰é’® (Robust Stop)

**ç›®æ ‡**: ç”¨æˆ·å¯ä»¥éšæ—¶ä¸­æ–­ AI çš„é•¿å“åº”ï¼Œä¸”åç«¯èƒ½æ­£ç¡®é‡Šæ”¾èµ„æºã€‚

**æŠ€æœ¯é£é™©**: `AbortController` æ— æ³•ç›´æ¥è·¨è¿›ç¨‹ä¼ é€’ã€‚

**è§£å†³æ–¹æ¡ˆ**: åœ¨ä¸»è¿›ç¨‹ç»´æŠ¤ `abortControllerMap`ã€‚

**æ”¹åŠ¨æ–‡ä»¶**:

- [`renderer/index.html`](renderer/index.html): æ·»åŠ åœæ­¢æŒ‰é’®
- [`main.js`](main.js): ç»´æŠ¤ `Map<requestId, AbortController>`
- [`preload.js`](preload.js): æš´éœ² `abortRequest` æ–¹æ³•

**å…³é”®å®ç°**:

```javascript
// main.js
const activeRequests = new Map();

ipcMain.handle('send-message', async (event, { id, message }) => {
  const controller = new AbortController();
  activeRequests.set(id, controller);

  try {
    // è°ƒç”¨ SDKï¼Œä¼ å…¥ controller.signal
    await agent.run(message, { signal: controller.signal });
  } finally {
    activeRequests.delete(id);
  }
});

ipcMain.on('abort-request', (event, id) => {
  const controller = activeRequests.get(id);
  if (controller) {
    controller.abort();
    activeRequests.delete(id);
  }
});
```

**é¢„ä¼°å·¥æ—¶**: 3h

---

### 1.3 Toast é€šçŸ¥ç³»ç»Ÿ (Moved to P0)

**ç›®æ ‡**: æ›¿ä»£æµè§ˆå™¨åŸç”Ÿ alertï¼Œæä¾›ä¼˜é›…ã€ç»Ÿä¸€çš„åé¦ˆæœºåˆ¶ã€‚

**ç†ç”±**: æ—¢ç„¶ Phase 1 åŒ…å«é”™è¯¯é‡è¯•å’Œåœæ­¢æ“ä½œï¼Œå¿…é¡»æœ‰åŸºç¡€çš„åé¦ˆ UIï¼Œé¿å…â€œåŠæˆå“â€æ„Ÿã€‚

**æ”¹åŠ¨æ–‡ä»¶**:

- [`renderer/style.css`](renderer/style.css): Toast æ ·å¼ (æ·¡å…¥æ·¡å‡ºåŠ¨ç”»)
- [`renderer/renderer.js`](renderer/renderer.js): `showToast(msg, type)`

**å…³é”®å®ç°**:
å‚è€ƒåŸè®¡åˆ’ï¼Œæ”¯æŒ `success`, `error`, `info` ä¸‰ç§çŠ¶æ€ã€‚

**é¢„ä¼°å·¥æ—¶**: 2h

---

### 1.4 ç½‘ç»œé”™è¯¯é‡è¯•æœºåˆ¶

**ç›®æ ‡**: ç½‘ç»œé”™è¯¯æ—¶æä¾›å‹å¥½çš„é‡è¯•é€‰é¡¹ã€‚
**ç—›ç‚¹**: çº¢è‰²é”™è¯¯æ–‡æœ¬ä¸å¯äº¤äº’ï¼Œç”¨æˆ·éœ€é‡æ–°è¾“å…¥ã€‚
**å®ç°**: é”™è¯¯å¡ç‰‡åŒ…å«â€œé‡æ–°å‘é€â€æŒ‰é’®ï¼Œå¤ç”¨ `showToast` æç¤ºç»“æœã€‚

**é¢„ä¼°å·¥æ—¶**: 2h

---

### 1.5 é¦–é¡µå¿«é€Ÿå¼€å§‹æ¨¡æ¿

**ç›®æ ‡**: é™ä½å†·å¯åŠ¨é—¨æ§›ã€‚
**å†…å®¹**: 3ä¸ªç²¾ç®€å¡ç‰‡ï¼ˆä»£ç å®¡æŸ¥ã€æ¦‚å¿µè§£é‡Šã€è°ƒè¯•åŠ©æ‰‹ï¼‰ã€‚

**é¢„ä¼°å·¥æ—¶**: 2.5h

---

## Phase 2: å¼€å‘è€…ä½“éªŒä¸å¢å¼º (P1)

**ç›®æ ‡ï¼šé’ˆå¯¹æ ¸å¿ƒç”¨æˆ·ç¾¤ï¼ˆå¼€å‘è€…ï¼‰ä¼˜åŒ–ä½“éªŒï¼Œæå‡äº§å“å®Œæ•´åº¦**

### 2.1 ä»£ç å—ä½“éªŒä¼˜åŒ– (Dev Experience) ğŸ†•

**ç›®æ ‡**: è®©ä»£ç é˜…è¯»å’Œä½¿ç”¨æ›´ä¾¿æ·ã€‚

**æ”¹åŠ¨æ–‡ä»¶**:

- [`renderer/renderer.js`](renderer/renderer.js): Markdown æ¸²æŸ“åå¤„ç†
- [`renderer/style.css`](renderer/style.css): ä»£ç å—æ ·å¼

**å…³é”®å®ç°**:

1. **è¯­è¨€æ ‡è¯†**: åœ¨ä»£ç å—å³ä¸Šè§’æ˜¾ç¤º `js`, `python` ç­‰ã€‚
2. **ä¸€é”®å¤åˆ¶**: æ‚¬æµ®æ˜¾ç¤ºå¤åˆ¶æŒ‰é’®ï¼Œç‚¹å‡»åé€šè¿‡ Toast åé¦ˆâ€œå·²å¤åˆ¶â€ã€‚
3. **è¯­æ³•é«˜äº®**: å¼•å…¥è½»é‡çº§é«˜äº®åº“ï¼ˆå¦‚ `highlight.js` æˆ– `prism.js`ï¼Œè‹¥åŒ…ä½“ç§¯å—é™å¯ä»…æ”¯æŒä¸»æµè¯­è¨€ï¼‰ã€‚

```javascript
function enhanceCodeBlocks(container) {
  container.querySelectorAll('pre code').forEach(block => {
    // 1. æ·»åŠ å¤åˆ¶æŒ‰é’®å®¹å™¨
    const wrapper = document.createElement('div');
    wrapper.className = 'code-wrapper';

    // 2. æ³¨å…¥ Header (è¯­è¨€ + å¤åˆ¶)
    const header = document.createElement('div');
    header.className = 'code-header';
    header.innerHTML = `
      <span class="lang-tag">${block.className.replace('language-', '')}</span>
      <button class="copy-btn">Copy</button>
    `;

    // 3. é‡ç»„ DOM
    block.parentNode.replaceWith(wrapper);
    wrapper.appendChild(header);
    wrapper.appendChild(block.parentNode);
  });
}
```

**é¢„ä¼°å·¥æ—¶**: 3h

---

### 2.2 èŠå¤©å†å²æœç´¢

**ç›®æ ‡**: å¿«é€Ÿå®šä½å†å²å¯¹è¯ã€‚
**å®ç°**: ä¾§è¾¹æ é¡¶éƒ¨æœç´¢æ¡†ï¼Œå®æ—¶è¿‡æ»¤ `allChats` æ•°ç»„ã€‚

**é¢„ä¼°å·¥æ—¶**: 3h

---

### 2.3 æ—¶é—´åˆ†ç»„æ ‡ç­¾

**ç›®æ ‡**: èŠå¤©å†å²æŒ‰â€œä»Šå¤©/æ˜¨å¤©/è¿‘7å¤©â€åˆ†ç»„ã€‚
**å®ç°**: åœ¨æ¸²æŸ“åˆ—è¡¨æ—¶æ’å…¥åˆ†éš”ç¬¦ã€‚

**é¢„ä¼°å·¥æ—¶**: 2h

---

### 2.4 é‡æ–°ç”ŸæˆæŒ‰é’®

**ç›®æ ‡**: å¯¹ä¸æ»¡æ„çš„ AI å›å¤å¯ä»¥é‡æ–°ç”Ÿæˆã€‚
**é€»è¾‘**:

1. æ‰¾åˆ°å¯¹åº”çš„ä¸Šä¸€æ¡ User Messageã€‚
2. åˆ é™¤å½“å‰ Assistant Messageã€‚
3. é‡æ–°è§¦å‘å‘é€é€»è¾‘ã€‚

**é¢„ä¼°å·¥æ—¶**: 2h

---

### 2.5 ä¸°å¯ŒåŠ è½½çŠ¶æ€ (Honest UI)

**ç›®æ ‡**: è¯šå®åé¦ˆ AI å½“å‰çŠ¶æ€ï¼Œç¼“è§£ç­‰å¾…ç„¦è™‘ã€‚

**çŠ¶æ€ç»†åˆ†**:

- ğŸ”µ **æ­£åœ¨æ€è€ƒ (Thinking)**: æ¥æ”¶åˆ° SDK çš„æ€è€ƒäº‹ä»¶ã€‚
- ğŸŸ  **æ­£åœ¨ä½¿ç”¨å·¥å…· (Using Tool)**: æ˜¾ç¤ºå…·ä½“å·¥å…·åï¼ˆå¦‚ `Using file_search...`ï¼‰ã€‚
- ğŸŸ¢ **æ­£åœ¨è¾“å…¥ (Writing)**: æ¥æ”¶åˆ°æ–‡æœ¬æµã€‚

**æ”¹åŠ¨**: ä¿®æ”¹æµå¼å“åº”å¤„ç†é€»è¾‘ï¼Œæ ¹æ®äº‹ä»¶ç±»å‹æ›´æ–° UI çŠ¶æ€æ ã€‚

**é¢„ä¼°å·¥æ—¶**: 2h

---

## Phase 3: æƒ…æ„ŸåŒ–ä¸ä¸ªæ€§åŒ– (P2)

**ç›®æ ‡ï¼šæå‡äº§å“ç²¾è‡´åº¦å’Œå¯ç”¨æ€§**

### 3.1 ä¸»é¢˜åˆ‡æ¢ (æ·±è‰²/æµ…è‰²)

æ”¯æŒæ·±è‰²æ¨¡å¼ï¼Œå‡è½»è§†è§‰ç–²åŠ³ã€‚ä½¿ç”¨ CSS å˜é‡å®ç°ã€‚

### 3.2 é”®ç›˜å¿«æ·é”®æ”¯æŒ

- `Cmd/Ctrl + N`: æ–°å»ºå¯¹è¯
- `Cmd/Ctrl + K`: èšç„¦æœç´¢
- `Escape`: ä¸­æ–­ç”Ÿæˆ/å…³é—­å¼¹çª—

### 3.3 å¯è®¿é—®æ€§æ”¹è¿›

ARIA æ ‡ç­¾ï¼Œç„¦ç‚¹ç®¡ç†ï¼Œå¯¹æ¯”åº¦ä¼˜åŒ–ã€‚

### 3.4 è®¾ç½®é¡µé¢

æ¨¡æ€æ¡†å½¢å¼ï¼Œé…ç½®æ¨¡å‹ã€ä¸»é¢˜ã€å¿«æ·é”®åå¥½ã€‚

**Phase 3 æ€»é¢„ä¼°**: 12h

---

## å®æ–½æ—¶é—´çº¿

| é˜¶æ®µ        | é¢„ä¼°å·¥æ—¶    | äº¤ä»˜ç‰©       | é‡ç‚¹                           |
| ----------- | ----------- | ------------ | ------------------------------ |
| **Phase 1** | 12h (2-3å¤©) | æ ¸å¿ƒä½“éªŒä¼˜åŒ– | ç¨³å¥è¾“å…¥ã€å¯æ§ç”Ÿæˆã€ç»Ÿä¸€åé¦ˆ   |
| **Phase 2** | 12h (3å¤©)   | åŠŸèƒ½å¢å¼º     | å¼€å‘è€…å‹å¥½ã€å†å²ç®¡ç†ã€é€æ˜çŠ¶æ€ |
| **Phase 3** | 12h (3å¤©)   | ä½“éªŒæ‰“ç£¨     | ä¸ªæ€§åŒ–ã€æ— éšœç¢ã€å¿«æ·æ“ä½œ       |

**æ€»è®¡**: ~36h (çº¦ 9 ä¸ªå·¥ä½œæ—¥)

---

## é£é™©ä¸æ³¨æ„äº‹é¡¹

1. **IPC é€šä¿¡**: åœæ­¢ç”ŸæˆåŠŸèƒ½å¿…é¡»ç¡®ä¿ä¸»è¿›ç¨‹æ­£ç¡®æ¸…ç†èµ„æºï¼Œé¿å…å†…å­˜æ³„æ¼ã€‚
2. **æ ·å¼éš”ç¦»**: ä»£ç å—çš„é«˜äº®æ ·å¼éœ€è¦ä¸ä¸»åº”ç”¨ä¸»é¢˜ï¼ˆæ·±/æµ…ï¼‰é€‚é…ã€‚
3. **æ€§èƒ½**: èŠå¤©å†å²æœç´¢å»ºè®®åŠ ä¸Šé˜²æŠ– (debounce)ï¼Œé¿å…å¤§é‡æ•°æ®ä¸‹çš„å¡é¡¿ã€‚
4. **æµ‹è¯•**: é‡ç‚¹æµ‹è¯•â€œé˜²è¯¯è§¦â€é€»è¾‘å’Œâ€œç½‘ç»œé‡è¯•â€æµç¨‹ï¼Œæ¨¡æ‹Ÿå¼±ç½‘ç¯å¢ƒã€‚
